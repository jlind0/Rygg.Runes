<?xml version="1.0" encoding="utf-8" ?>
<r:ReactiveContentPage x:TypeArguments="vm:MainWindowViewModel" x:DataType="vm:MainWindowViewModel" xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:r="clr-namespace:ReactiveUI.Maui;assembly=ReactiveUI.Maui"
             xmlns:telerik="http://schemas.telerik.com/2022/xaml/maui"
             xmlns:c="clr-namespace:RyggRunes.MAUI.Client.Converters;assembly=RyggRunes.MAUI.Client"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" xmlns:vm="clr-namespace:Rygg.Runes.Client.ViewModels;assembly=Rygg.Runes.Client.ViewModels"
             x:Class="RyggRunes.MAUI.Client.MainPage">
    <telerik:RadBusyIndicator x:Name="BusyIndicator"
                            AnimationContentHeightRequest="100"
                            AnimationContentWidthRequest="100"
                            AnimationContentColor="#674bb2"
                            AutomationId="busyIndicator" IsBusy="{Binding IsLoading}">
        <telerik:RadDockLayout x:Name="radDock">
            <Button Text="Login" WidthRequest="150" HeightRequest="50" Command="{Binding Login}" telerik:RadDockLayout.Dock="Top">
                <Button.Triggers>
                    <DataTrigger Binding="{Binding IsLoggedIn}" TargetType="Button"  Value="True">
                        <Setter Property="IsVisible" Value="False"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding IsLoggedIn}" TargetType="Button" Value="False">
                        <Setter Property="IsVisible" Value="True"/>
                    </DataTrigger>
                </Button.Triggers>
            </Button>

            <telerik:RadWrapLayout Orientation="Horizontal"  telerik:RadDockLayout.Dock="Top" IsVisible="{Binding HasRunes}">
                <VerticalStackLayout Margin="20">
                    <VerticalStackLayout.Resources>
                        <ResourceDictionary>
                            <c:ByteToImageSourceConverter x:Key="ByteArrayToImageSourceConverter"/>
                        </ResourceDictionary>
                    </VerticalStackLayout.Resources>
                    <Label>Runes</Label>
                    <ListView ItemsSource="{Binding Runes}"/>
                    <Image HeightRequest="300" WidthRequest="300"
Source="{Binding AnnotatedImage, Converter={StaticResource ByteArrayToImageSourceConverter}, Mode=OneWay}" 
Aspect="AspectFit" />

                </VerticalStackLayout>
                <VerticalStackLayout Margin="20"> 
                    <Label>Question</Label>
                    <Editor Text="{Binding Question}" WidthRequest="300" HeightRequest="150"></Editor>
                    <Button Text="Ask the Mystic" Command="{Binding AskFuture}" WidthRequest="250"/>
                    <ScrollView WidthRequest="300">
                        <Label TextType="Html" Text="{Binding Answer}"/>
                    </ScrollView>
                </VerticalStackLayout>
            </telerik:RadWrapLayout>
            <telerik:RadToolbar x:Name="toolbar" HeightRequest="75" telerik:RadDockLayout.Dock="Bottom" IsVisible="{Binding IsLoggedIn}">
                <telerik:ButtonToolbarItem Command="{Binding TakePhoto}">
                    <telerik:ButtonToolbarItem.ImageSource>
                        <FontImageSource Glyph="{x:StaticResource camera}"
                        FontFamily="FASolid"
                        Size="40" Color="Blue" />
                    </telerik:ButtonToolbarItem.ImageSource>
                </telerik:ButtonToolbarItem>
                <telerik:ButtonToolbarItem Command="{Binding ProcessImage}">
                    <telerik:ButtonToolbarItem.ImageSource>
                        <FontImageSource Glyph="{x:StaticResource photo}"
                            FontFamily="FASolid"
                            Size="40" Color="Blue" />
                    </telerik:ButtonToolbarItem.ImageSource>
                </telerik:ButtonToolbarItem>
            </telerik:RadToolbar>

        </telerik:RadDockLayout>
    </telerik:RadBusyIndicator>
    
    

</r:ReactiveContentPage>
